import sys
import os
import tensorflow as tf

from .loader import ThumbnailMultilabelLoader
from .estimator import MultilabelAddCenterlossClassifier


class Predictor(object):
    def __init__(self):
        # tf.logging.set_verbosity(tf.logging.INFO)
        self.loader = ThumbnailMultilabelLoader()
        self.estimator = MultilabelAddCenterlossClassifier(self.loader.label_num).get_estimator()

    def predict(self, blob):
        eval_result = self.estimator.predict(input_fn=self.loader.predict_content_input_fn([blob]))
        return next(eval_result)

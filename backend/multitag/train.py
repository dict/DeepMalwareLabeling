import tensorflow as tf
import os

from .estimator import MultilabelAddCenterlossClassifier
from .loader import ThumbnailMultilabelLoader


def main():
    tf.logging.set_verbosity(tf.logging.INFO)
    loader = ThumbnailMultilabelLoader()
    estimator = MultilabelAddCenterlossClassifier(loader.label_num).get_estimator()

    input_fn, hook = loader.train_input_fn()

    estimator.train(input_fn=input_fn, hooks=[hook])


if __name__ == '__main__':
    main()

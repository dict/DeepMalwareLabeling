import tensorflow as tf
import os

from .estimator import MultilabelAddCenterlossClassifier
from .loader import ThumbnailMultilabelLoader


def main():

    tf.logging.set_verbosity(tf.logging.INFO)

    loader = ThumbnailMultilabelLoader()
    estimator = MultilabelAddCenterlossClassifier(loader.label_num).get_estimator()

    input_fn, hook = loader.valid_input_fn()

    eval_result = estimator.evaluate(input_fn=input_fn, hooks=[hook])
    print(eval_result)


if __name__ == '__main__':
    main()
